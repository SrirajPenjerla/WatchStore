{"ast":null,"code":"import { BehaviorSubject, tap, catchError, throwError } from 'rxjs';\nimport { environment } from '../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nclass AuthService {\n  constructor(http) {\n    this.http = http;\n    this.currentUserSubject = new BehaviorSubject(null);\n    this.currentUser$ = this.currentUserSubject.asObservable();\n    const token = localStorage.getItem('token');\n    const user = localStorage.getItem('user');\n    if (token && user) {\n      this.currentUserSubject.next(JSON.parse(user));\n    }\n  }\n  register(userData) {\n    console.log('Attempting registration with data:', userData);\n    const url = `${environment.apiUrl}/auth/register`;\n    console.log('API URL:', url);\n    return this.http.post(url, userData, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).pipe(tap(response => {\n      console.log('Registration successful:', response);\n      this.handleAuthentication(response);\n    }), catchError(error => {\n      console.error('Registration error:', error);\n      return this.handleError(error);\n    }));\n  }\n  login(credentials) {\n    console.log('Attempting login with email:', credentials.email);\n    const url = `${environment.apiUrl}/auth/login`;\n    console.log('API URL:', url);\n    return this.http.post(url, credentials, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).pipe(tap(response => {\n      console.log('Login successful:', response);\n      this.handleAuthentication(response);\n    }), catchError(error => {\n      console.error('Login error:', error);\n      return this.handleError(error);\n    }));\n  }\n  logout() {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    this.currentUserSubject.next(null);\n  }\n  isAuthenticated() {\n    return !!this.getToken();\n  }\n  isAdmin() {\n    const user = this.currentUserSubject.value;\n    return user?.email === 'admin@example.com'; // Simple admin check for now\n  }\n  getToken() {\n    return localStorage.getItem('token');\n  }\n  handleAuthentication(response) {\n    localStorage.setItem('token', response.token);\n    localStorage.setItem('user', JSON.stringify(response.user));\n    this.currentUserSubject.next(response.user);\n  }\n  handleError(error) {\n    console.error('Error details:', {\n      status: error.status,\n      statusText: error.statusText,\n      error: error.error,\n      message: error.message\n    });\n    let errorMessage = 'An error occurred. Please try again.';\n    if (error.error instanceof ErrorEvent) {\n      // Client-side error\n      errorMessage = error.error.message;\n    } else {\n      // Server-side error\n      const apiError = error.error;\n      errorMessage = apiError?.message || errorMessage;\n    }\n    return throwError(() => errorMessage);\n  }\n  static {\n    this.ɵfac = function AuthService_Factory(t) {\n      return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: AuthService,\n      factory: AuthService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}\nexport { AuthService };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}