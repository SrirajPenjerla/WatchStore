{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../../../services/product.service\";\nimport * as i3 from \"../../../../features/cart/services/cart.service\";\nimport * as i4 from \"../../../../shared/services/toast.service\";\nimport * as i5 from \"../../../../services/auth.service\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@angular/forms\";\nfunction ProductDetailComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4)(1, \"div\", 5)(2, \"span\", 6);\n    i0.ɵɵtext(3, \"Loading...\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction ProductDetailComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.error, \" \");\n  }\n}\nfunction ProductDetailComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"div\", 9);\n    i0.ɵɵelement(2, \"img\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 9)(4, \"h2\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 11);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\", 12);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 13)(11, \"h3\", 14);\n    i0.ɵɵtext(12);\n    i0.ɵɵpipe(13, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"p\", 11);\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(16, \"div\", 13)(17, \"div\", 15)(18, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function ProductDetailComponent_div_3_Template_button_click_18_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.updateQuantity(ctx_r3.quantity - 1));\n    });\n    i0.ɵɵtext(19, \" - \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"input\", 17);\n    i0.ɵɵlistener(\"ngModelChange\", function ProductDetailComponent_div_3_Template_input_ngModelChange_20_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.quantity = $event);\n    })(\"change\", function ProductDetailComponent_div_3_Template_input_change_20_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.validateQuantity());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function ProductDetailComponent_div_3_Template_button_click_21_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.updateQuantity(ctx_r7.quantity + 1));\n    });\n    i0.ɵɵtext(22, \" + \");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(23, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function ProductDetailComponent_div_3_Template_button_click_23_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.addToCart());\n    });\n    i0.ɵɵtext(24);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", ctx_r2.product.imageUrl, i0.ɵɵsanitizeUrl)(\"alt\", ctx_r2.product.name);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r2.product.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.product.brand);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.product.description);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(13, 14, ctx_r2.product.price));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\" \", ctx_r2.product.stockQuantity > 0 ? \"In Stock\" : \"Out of Stock\", \" (\", ctx_r2.product.stockQuantity, \" available) \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", ctx_r2.quantity <= 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", ctx_r2.quantity)(\"max\", ctx_r2.product.stockQuantity);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", ctx_r2.quantity >= ctx_r2.product.stockQuantity);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r2.product.stockQuantity === 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.product.stockQuantity === 0 ? \"Out of Stock\" : \"Add to Cart\", \" \");\n  }\n}\nclass ProductDetailComponent {\n  constructor(route, router, productService, cartService, toastService, authService) {\n    this.route = route;\n    this.router = router;\n    this.productService = productService;\n    this.cartService = cartService;\n    this.toastService = toastService;\n    this.authService = authService;\n    this.product = null;\n    this.loading = true;\n    this.error = null;\n    this.quantity = 1;\n  }\n  ngOnInit() {\n    const productId = Number(this.route.snapshot.paramMap.get('id'));\n    this.loadProduct(productId);\n  }\n  loadProduct(id) {\n    this.loading = true;\n    this.error = null;\n    this.productService.getProduct(id).subscribe({\n      next: product => {\n        this.product = product;\n        this.loading = false;\n      },\n      error: error => {\n        this.error = 'Failed to load product details. Please try again later.';\n        this.loading = false;\n        this.toastService.error('Failed to load product details. Please try again later.');\n      }\n    });\n  }\n  updateQuantity(newQuantity) {\n    if (this.product) {\n      this.quantity = Math.max(1, Math.min(newQuantity, this.product.stockQuantity));\n    }\n  }\n  validateQuantity() {\n    if (this.product) {\n      this.quantity = Math.max(1, Math.min(this.quantity, this.product.stockQuantity));\n    }\n  }\n  addToCart() {\n    if (!this.product) return;\n    if (!this.authService.isAuthenticated()) {\n      this.toastService.error('Please login to add items to cart');\n      this.router.navigate(['/auth/login']);\n      return;\n    }\n    console.log('ProductDetailComponent.addToCart() - Adding product to cart:', this.product.id, this.quantity);\n    this.cartService.addToCart(this.product.id, this.quantity).subscribe({\n      next: response => {\n        console.log('ProductDetailComponent.addToCart() - Response received:', response);\n        this.toastService.success('Product added to cart successfully');\n      },\n      error: error => {\n        console.error('ProductDetailComponent.addToCart() - Error:', error);\n        this.error = 'Failed to add product to cart. Please try again.';\n        this.toastService.error('Failed to add product to cart. Please try again.');\n      }\n    });\n  }\n  static {\n    this.ɵfac = function ProductDetailComponent_Factory(t) {\n      return new (t || ProductDetailComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.ProductService), i0.ɵɵdirectiveInject(i3.CartService), i0.ɵɵdirectiveInject(i4.ToastService), i0.ɵɵdirectiveInject(i5.AuthService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ProductDetailComponent,\n      selectors: [[\"app-product-detail\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 4,\n      vars: 3,\n      consts: [[1, \"container\"], [\"class\", \"text-center\", 4, \"ngIf\"], [\"class\", \"alert alert-danger\", 4, \"ngIf\"], [\"class\", \"row\", 4, \"ngIf\"], [1, \"text-center\"], [\"role\", \"status\", 1, \"spinner-border\"], [1, \"visually-hidden\"], [1, \"alert\", \"alert-danger\"], [1, \"row\"], [1, \"col-md-6\"], [1, \"img-fluid\", \"rounded\", 3, \"src\", \"alt\"], [1, \"text-muted\"], [1, \"lead\"], [1, \"mb-4\"], [1, \"text-primary\"], [1, \"input-group\", 2, \"width\", \"150px\"], [\"type\", \"button\", 1, \"btn\", \"btn-outline-secondary\", 3, \"disabled\", \"click\"], [\"type\", \"number\", \"min\", \"1\", 1, \"form-control\", \"text-center\", 3, \"ngModel\", \"max\", \"ngModelChange\", \"change\"], [1, \"btn\", \"btn-primary\", \"btn-lg\", \"w-100\", 3, \"disabled\", \"click\"]],\n      template: function ProductDetailComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0);\n          i0.ɵɵtemplate(1, ProductDetailComponent_div_1_Template, 4, 0, \"div\", 1);\n          i0.ɵɵtemplate(2, ProductDetailComponent_div_2_Template, 2, 1, \"div\", 2);\n          i0.ɵɵtemplate(3, ProductDetailComponent_div_3_Template, 25, 16, \"div\", 3);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.loading);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.error);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading && !ctx.error && ctx.product);\n        }\n      },\n      dependencies: [CommonModule, i6.NgIf, i6.CurrencyPipe, FormsModule, i7.DefaultValueAccessor, i7.NumberValueAccessor, i7.NgControlStatus, i7.MinValidator, i7.MaxValidator, i7.NgModel],\n      styles: [\".input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\\n      border-left: none;\\n      border-right: none;\\n    }\\n    .input-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] {\\n      border-color: #ced4da;\\n    }\\n    .input-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover {\\n      background-color: #f8f9fa;\\n    }\\n    .img-fluid[_ngcontent-%COMP%] {\\n      max-height: 500px;\\n      object-fit: contain;\\n    }\"]\n    });\n  }\n}\nexport { ProductDetailComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}